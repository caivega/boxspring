<html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, target-densitydpi=medium-dpi" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
	<meta name="format-detection" content="telephone=no" />
</head>
<body>
	<style>
		body {
			margin: 0px;
			padding: 0px;
		}
	</style>



	<script type="text/javascript" src="../boxspring.js"></script>
	<script type="text/javascript">
		var count = 0

		document.addEventListener('touchstart', function(e) {
			e.preventDefault()
		})


		var View   = boxspring.view.View
		var Window = boxspring.view.Window

		var r = 0
		var g = 0
		var b = 200

		var createView = function() {
			var r = Math.round(Math.random() * 255)
			var g = Math.round(Math.random() * 255)
			var b = Math.round(Math.random() * 255)
			var view = new View()
			view.name = 'View - ' + (++count)
			view.backgroundColor = 'rgba(' + r + ' ,' + g + ',' + b + ', 0.5)';
			return view
		}

		var root = boxspring.view.Window.instance()
		root.name = 'Window'
		root.backgroundColor = 'rgba(200, 200, 200, 0.5)'
		root.size.x = 'auto'
		root.size.y = 'auto'

		var forwarder = new boxspring.event.TouchForwarder(root)

		var view = createView()
		view.position.x = 100
		view.position.y = 100
		view.size.x = 100
		view.size.y = 100
		root.addChild(view)

		var color = view.backgroundColor
		var touch = false

		var offsetX = 0
		var offsetY = 0

		view.on('touchstart', function(touches, e) {
			offsetX = touches[0].location.x - view.measuredOffset.x
			offsetY = touches[0].location.y - view.measuredOffset.y
			view.backgroundColor = 'blue'
			touch = true
		})

		view.on('touchend', function(touches, e) {
			view.backgroundColor = color
			touch = false
		})

		view.on('touchmove', function(touches, e) {
			view.position.x = touches[0].location.x - offsetX
			view.position.y = touches[0].location.y - offsetY
		})

		console.log(view.position)

		//
		// Animations
		//
/*
		for (var i = 0; i < 5; i++) {
			var view = createView()
			view.size.x = 'fill'
			view.size.y = 'fill'
			root.addChild(view)
		}

		var animate = function() {

			var view = createView()
			view.size.y = 0

			root.addChild(view)





			View.setupAnimation(1200)
			view.size.y = 'fill'
			//root.contentLayout.orientation = root.contentLayout.orientation === 'horizontal' ? 'vertical' : 'horizontal'
			View.startAnimation()
		}

		document.addEventListener('touchend', animate)
*/
/*
		//
		//
		//

		var scrollview = new boxspring.view.ScrollView()
		scrollview.backgroundColor = 'rgba(255, 0, 0, 0.5)'
		scrollview.name = 'Scroll View'
		root.addChild(scrollview)

		scrollview.contentSize.x = 'fill'
		scrollview.contentSize.y = 10000

		for (var i = 0; i < 100; i++) {
			var view = createView()

			view.name = 'View' + i
			view.size.x = 'fill'
			view.size.y = 100
			view.padding = 20
			scrollview.addChild(view)
			// var sub = createView()
			// sub.backgroundColor = 'rgba(255, 255, 255, 0.5)'
			// sub.name = 'View' + i + '--- SUB'
			// view.addChild(sub)
			// var sub = createView()
			// sub.backgroundColor = 'rgba(255, 255, 255, 0.4)'
			// sub.name = 'View' + i + '--- SUB'
			// view.addChild(sub)
			// var sub = createView()
			// sub.backgroundColor = 'rgba(255, 255, 255, 0.3)'
			// sub.name = 'View' + i + '--- SUB'
			// view.addChild(sub)
		}

		// setTimeout(function() {
		// 	console.log('######## Re-Rendering ########')
		// 	scrollview.scheduleRender()

		// }, 2000)
*/
	</script>

</body>
</html>